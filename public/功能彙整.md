# 功能彙整（以 UI 可見為準）

> 本文件只整理「你在畫面上看得到、操作得到」的功能與行為，不包含程式檔案位置與內部實作細節。

---

## 1) 載入與資料來源

### 1.1 載入狀態
- 進入頁面後會先看到 `Loading...`。
- 若載入失敗，會顯示「載入失敗：<錯誤訊息>」的提示面板。

### 1.2 資料來源切換（左上角）
- `假資料`：使用程式即時產生的範例資料。
- `fakedata.json`：載入 `public/fakedata.json` 的資料。
- 切換資料來源後，會重新載入並刷新整張圖。

> 補充：若 mock 估算資料量過大，系統會阻止切換並提示，改用 `fakedata.json`（避免瀏覽器卡住）。

---

## 2) 圖形主畫布（Graph）

### 2.1 初始視圖（預設顯示哪些節點）
- 預設只顯示「理專」節點，其他類型節點會先隱藏，避免一開始資訊爆量。

### 2.2 背景水印
- 圖區中央會有淡淡的背景水印（不影響滑鼠互動）。

---

## 3) 搜尋（上方置中）

### 3.1 節點搜尋
- 可輸入關鍵字搜尋節點名稱（模糊包含比對）。
- 搜尋有結果時：
  - 會顯示 `目前第幾筆 / 總共幾筆`。
  - 可用按鈕「上一筆 / 下一筆」切換聚焦。
  - 也可按 `Enter` 直接跳到下一筆。

### 3.2 自動展開與定位
- 點選搜尋結果後會自動：
  - 把該節點「往上層的結構路徑」需要顯示的節點全部展開（確保看得到上下文）。
  - 鏡頭自動移動並放大定位到該節點。

---

## 4) 右鍵選單（對節點右鍵）

在任一節點上按右鍵會出現選單：
- `展開 (Expand)`：顯示該節點的「結構子節點」（往外延伸的下一層）。
- `資料詳情`：打開右側資料面板，顯示該節點的欄位內容。
- `隱藏 (Hide)`：把該節點的「結構子節點」隱藏起來（並同步隱藏相關連線）。

---

## 5) 右側資料面板（資料詳情）

### 5.1 觸發方式
- 右鍵節點 → `資料詳情`。

### 5.2 顯示內容
- 會依節點類型（理專 / 客戶 / 投資組合 / 帳號）顯示不同欄位。
- 面板右上角 `X` 可關閉。

---

## 6) 展開模式切換（右上角）

右上角有兩個模式按鈕：
- `Structure`：展開後的子節點以「偏結構化扇出」方式排列，優先避免重疊。
- `Circle`：展開時把「本次新顯示」的子節點用圓形均分散開，適合快速看周邊關係。

---

## 7) 拖曳節點（滑鼠左鍵）

- 可用滑鼠左鍵拖曳節點改位置。
- 拖曳後節點會被視為「固定」，後續自動排版/展開重排會盡量不再移動它（避免你手動調整被覆蓋）。

---

## 8) Hover 顯示（滑過節點/邊）

### 8.1 節點 Hover Tooltip
- 滑過節點會出現一個小提示框（顯示節點名稱）。

### 8.2 邊文字（Edge Label）顯示規則
- 一般情況下：
  - 滑過某條邊時，該邊的文字會顯示。
  - 沒有滑過時，需要把畫面放大到一定程度才會顯示邊文字（避免縮小時滿畫面都是字）。
- Demo 例外（平行交易）：
  - 名稱以「平行交易」開頭的邊，會固定顯示文字，方便確認平行邊效果。

---

## 9) 平行邊（A→B 多條邊）顯示效果

- 若存在同方向 `A → B` 多條邊，畫面會以「曲線」方式將多條邊分開，避免完全重疊看不出來。
- 在假資料模式下，系統會保證至少有一組「同方向三條平行交易邊」可用來驗證（名稱為 `平行交易A-1/2/3`，有時會再多一組 `平行交易B-1/2/3`）。

---

## 10) 右下角控制列

- `ZoomControl`：放大 / 縮小 / 重置視角（視使用的控制元件行為而定）。
- `FullScreenControl`：切換全螢幕 / 離開全螢幕。

---

## 11) 使用建議（最常見操作）

- 想從總覽開始探索：先看理專節點 → 右鍵 `展開` 往下層一層層展開。
- 想快速定位：用搜尋直接跳到目標節點，系統會自動展開祖先並置中。
- 想整理畫面：對節點右鍵 `隱藏`，把不需要的分支收起來。
